#!/bin/sh
# check external executables to resolve dependency
require(){
  chk -e $1
  for shelib_i in $@; do 
    shelib_setdir_loaded=${SHELIB_DIR:?SHELIB_DIR not defined}/${shelib_i##@}
    case $1 in 
      @*/*) ## @pkgname/module syntax: load shelib module from SHELIB_DIR
        test -f ${SHELIB_DIR}/${1:##@} || throw "$1 not exist in shelibdir"
        . $shelib_setdir_loaded || throw "loading failure" ;;
      @*) ## [^@] syntax: load shellscripts from shpkg in shelib dir
        test -d "$shelib_setdir_loaded" \
          && for shelib_j in $shelib_setdir_loaded/* ; do . $shelib_j ; done \
          || throw shpkg $1 not found;;
      /*) ## /path/to/script syntax: 
        test -f $1 && . $1 || throw "failed to load $1" ;;
      *) ## generic requirement check: check executable exists in PATH or not
        sanitize $shelib_i; chk -x $shelib_i ;;
    esac
  done
  return 0
}
